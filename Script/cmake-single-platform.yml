name: QCS6490 Development Release Pipeline

on:
  push:
    branches:
      - development     # Trigger ONLY when pushing to development branch

jobs:
  build:
    runs-on: [self-hosted, linux]     

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run multi-feature build script in VM
        run: bash /home/cto/build_script/build_all_branches.sh

      - name: Upload FINAL ZIP to GitHub Release
        uses: softprops/action-gh-release@v1
        if: success()
        with:
          tag_name: "dev-build-${{ github.run_number }}"
          name: "Development Build ${{ github.run_number }}"
          body: |
            This is an autogenerated release from the development branch.
            It contains one final ZIP file with all feature binaries.
          files: |
            /home/cto/qcs_builds/final_development_build.zip
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
